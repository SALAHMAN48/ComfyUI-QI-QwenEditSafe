{
  "id": "873aac8a-4e0b-46b1-b1ae-ba0c2a04c941",
  "revision": 0,
  "last_node_id": 263,
  "last_link_id": 645,
  "nodes": [
    {
      "id": 66,
      "type": "ModelSamplingAuraFlow",
      "pos": [
        333.92730712890625,
        -33.99247741699219
      ],
      "size": [
        310,
        58
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 410
        }
      ],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            213
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.51",
        "Node name for S&R": "ModelSamplingAuraFlow"
      },
      "widgets_values": [
        3.1
      ]
    },
    {
      "id": 116,
      "type": "CFGNorm",
      "pos": [
        742.815673828125,
        -43.97135925292969
      ],
      "size": [
        270,
        58
      ],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 213
        }
      ],
      "outputs": [
        {
          "name": "patched_model",
          "type": "MODEL",
          "links": [
            214,
            639
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "Node name for S&R": "CFGNorm"
      },
      "widgets_values": [
        1
      ]
    },
    {
      "id": 248,
      "type": "QI_RefEditEncode_Safe",
      "pos": [
        316.7974853515625,
        166.9230194091797
      ],
      "size": [
        445.4541320800781,
        304
      ],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 644
        },
        {
          "name": "image",
          "type": "IMAGE",
          "link": 616
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 617
        },
        {
          "name": "image2",
          "shape": 7,
          "type": "IMAGE",
          "link": 618
        },
        {
          "name": "image3",
          "shape": 7,
          "type": "IMAGE",
          "link": 619
        }
      ],
      "outputs": [
        {
          "name": "conditioning",
          "type": "CONDITIONING",
          "links": [
            620,
            621
          ]
        },
        {
          "name": "image",
          "type": "IMAGE",
          "links": []
        },
        {
          "name": "latent",
          "type": "LATENT",
          "links": null
        }
      ],
      "properties": {
        "Node name for S&R": "QI_RefEditEncode_Safe"
      },
      "widgets_values": [
        "构图改为特写，图一的老人抱着图二的女人在图三的背景中，保持图二人物一致性",
        0,
        0,
        1,
        "natural"
      ]
    },
    {
      "id": 147,
      "type": "ConditioningZeroOut",
      "pos": [
        853.7645263671875,
        285.6126708984375
      ],
      "size": [
        140,
        26
      ],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "conditioning",
          "type": "CONDITIONING",
          "link": 620
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "links": [
            602
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "Node name for S&R": "ConditioningZeroOut"
      },
      "widgets_values": []
    },
    {
      "id": 3,
      "type": "KSampler",
      "pos": [
        1129.4639892578125,
        -42.79478073120117
      ],
      "size": [
        310,
        457.25
      ],
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 214
        },
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 621
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 602
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 591
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "slot_index": 0,
          "links": [
            336
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.51",
        "Node name for S&R": "KSampler"
      },
      "widgets_values": [
        0,
        "fixed",
        4,
        1,
        "euler",
        "simple",
        1
      ]
    },
    {
      "id": 161,
      "type": "QI_VAEDecodeLockSize",
      "pos": [
        1618.2894287109375,
        92.54651641845703
      ],
      "size": [
        362.5152282714844,
        102
      ],
      "flags": {},
      "order": 17,
      "mode": 0,
      "inputs": [
        {
          "name": "vae",
          "type": "VAE",
          "link": 335
        },
        {
          "name": "latent",
          "type": "LATENT",
          "link": 336
        }
      ],
      "outputs": [
        {
          "name": "image",
          "type": "IMAGE",
          "links": [
            455
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "QI_VAEDecodeLockSize"
      },
      "widgets_values": [
        false,
        false
      ]
    },
    {
      "id": 197,
      "type": "EmptyLatentImage",
      "pos": [
        810.690185546875,
        571.0197143554688
      ],
      "size": [
        270,
        106
      ],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [
            591,
            638
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "Node name for S&R": "EmptyLatentImage"
      },
      "widgets_values": [
        1536,
        960,
        1
      ]
    },
    {
      "id": 261,
      "type": "ConditioningZeroOut",
      "pos": [
        915.6055908203125,
        883.3775024414062
      ],
      "size": [
        140,
        26
      ],
      "flags": {},
      "order": 13,
      "mode": 0,
      "inputs": [
        {
          "name": "conditioning",
          "type": "CONDITIONING",
          "link": 635
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "links": [
            636
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "Node name for S&R": "ConditioningZeroOut"
      },
      "widgets_values": []
    },
    {
      "id": 251,
      "type": "KSampler",
      "pos": [
        1181.4910888671875,
        566.2031860351562
      ],
      "size": [
        310,
        457.25
      ],
      "flags": {},
      "order": 16,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 639
        },
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 637
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 636
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 638
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "slot_index": 0,
          "links": [
            623
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.51",
        "Node name for S&R": "KSampler"
      },
      "widgets_values": [
        0,
        "fixed",
        4,
        1,
        "euler",
        "simple",
        1
      ]
    },
    {
      "id": 252,
      "type": "QI_VAEDecodeLockSize",
      "pos": [
        1628.77978515625,
        575.4362182617188
      ],
      "size": [
        362.5152282714844,
        102
      ],
      "flags": {},
      "order": 18,
      "mode": 0,
      "inputs": [
        {
          "name": "vae",
          "type": "VAE",
          "link": 640
        },
        {
          "name": "latent",
          "type": "LATENT",
          "link": 623
        }
      ],
      "outputs": [
        {
          "name": "image",
          "type": "IMAGE",
          "links": [
            641
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "QI_VAEDecodeLockSize"
      },
      "widgets_values": [
        false,
        false
      ]
    },
    {
      "id": 160,
      "type": "PreviewImage",
      "pos": [
        2133.21337890625,
        94.59803771972656
      ],
      "size": [
        535.2235717773438,
        432.88812255859375
      ],
      "flags": {},
      "order": 19,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 455
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "Node name for S&R": "PreviewImage"
      },
      "widgets_values": []
    },
    {
      "id": 262,
      "type": "PreviewImage",
      "pos": [
        2683.593017578125,
        99.8985824584961
      ],
      "size": [
        500.8824157714844,
        415.5379638671875
      ],
      "flags": {},
      "order": 20,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 641
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "Node name for S&R": "PreviewImage"
      },
      "widgets_values": []
    },
    {
      "id": 195,
      "type": "CLIPLoader",
      "pos": [
        -183.2339324951172,
        77.82600402832031
      ],
      "size": [
        380,
        106
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "links": [
            630,
            644
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "Node name for S&R": "CLIPLoader"
      },
      "widgets_values": [
        "qwen_2.5_vl_7b.safetensors",
        "qwen_image",
        "default"
      ]
    },
    {
      "id": 80,
      "type": "LoraLoaderModelOnly",
      "pos": [
        305.90472412109375,
        -169.36932373046875
      ],
      "size": [
        430,
        82
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 281
        }
      ],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            410
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.51",
        "Node name for S&R": "LoraLoaderModelOnly",
        "models": [
          {
            "name": "Qwen-Image-Lightning-4steps-V1.0.safetensors",
            "url": "https://huggingface.co/lightx2v/Qwen-Image-Lightning/resolve/main/Qwen-Image-Lightning-4steps-V1.0.safetensors",
            "directory": "loras"
          }
        ]
      },
      "widgets_values": [
        "QWEN\\Qwen-Image-Lightning-4steps-V2.0.safetensors",
        1
      ]
    },
    {
      "id": 37,
      "type": "UNETLoader",
      "pos": [
        -178.3238067626953,
        -178.55996704101562
      ],
      "size": [
        380,
        82
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "slot_index": 0,
          "links": [
            281
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.51",
        "Node name for S&R": "UNETLoader",
        "models": [
          {
            "name": "qwen_image_fp8_e4m3fn.safetensors",
            "url": "https://huggingface.co/Comfy-Org/Qwen-Image_ComfyUI/resolve/main/split_files/diffusion_models/qwen_image_fp8_e4m3fn.safetensors",
            "directory": "diffusion_models"
          }
        ]
      },
      "widgets_values": [
        "QWEN\\qwen_image_edit_2509_fp8_e4m3fn.safetensors",
        "default"
      ]
    },
    {
      "id": 109,
      "type": "NunchakuQwenImageDiTLoader",
      "pos": [
        -178.29345703125,
        -412.2618103027344
      ],
      "size": [
        440.3763122558594,
        139.8472137451172
      ],
      "flags": {},
      "order": 3,
      "mode": 4,
      "inputs": [],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": []
        }
      ],
      "properties": {
        "cnr_id": "nunchaku_nodes",
        "ver": "d329ebab041199eee4d70689da17495df629bd64",
        "Node name for S&R": "NunchakuQwenImageDiTLoader"
      },
      "widgets_values": [
        "QWEN\\svdq-fp4_r128-qwen-image-edit.safetensors",
        "enable",
        1,
        "enable"
      ]
    },
    {
      "id": 39,
      "type": "VAELoader",
      "pos": [
        -174.29379272460938,
        332.4389343261719
      ],
      "size": [
        380,
        58
      ],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "VAE",
          "type": "VAE",
          "slot_index": 0,
          "links": [
            335,
            617,
            634,
            640
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.51",
        "Node name for S&R": "VAELoader",
        "models": [
          {
            "name": "qwen_image_vae.safetensors",
            "url": "https://huggingface.co/Comfy-Org/Qwen-Image_ComfyUI/resolve/main/split_files/vae/qwen_image_vae.safetensors",
            "directory": "vae"
          }
        ]
      },
      "widgets_values": [
        "QWEN\\qwen_image_vae.safetensors"
      ]
    },
    {
      "id": 110,
      "type": "LoadImage",
      "pos": [
        -809.0155029296875,
        21.162622451782227
      ],
      "size": [
        340.66082763671875,
        640.5018310546875
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            616,
            631
          ]
        },
        {
          "name": "MASK",
          "type": "MASK",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.51",
        "Node name for S&R": "LoadImage"
      },
      "widgets_values": [
        "212B5D6E8BD091B1087C4668E8F6784B.jpg",
        "image"
      ]
    },
    {
      "id": 198,
      "type": "LoadImage",
      "pos": [
        -811.4151611328125,
        715.7100219726562
      ],
      "size": [
        339.4916076660156,
        515.4801635742188
      ],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            618,
            632
          ]
        },
        {
          "name": "MASK",
          "type": "MASK",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "Node name for S&R": "LoadImage"
      },
      "widgets_values": [
        "模特1.jpg",
        "image"
      ]
    },
    {
      "id": 71,
      "type": "LoadImage",
      "pos": [
        -794.7865600585938,
        1285.6690673828125
      ],
      "size": [
        325.3570556640625,
        587.64794921875
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            619,
            633
          ]
        },
        {
          "name": "MASK",
          "type": "MASK",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.51",
        "Node name for S&R": "LoadImage"
      },
      "widgets_values": [
        "E58451B79BE7D6E729BC2C4F6A4CC68C.png",
        "image"
      ]
    },
    {
      "id": 260,
      "type": "QI_TextEncodeQwenImageEdit_Safe",
      "pos": [
        312.66375732421875,
        589.339599609375
      ],
      "size": [
        447.6726989746094,
        460.2619323730469
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 630
        },
        {
          "name": "image",
          "type": "IMAGE",
          "link": 631
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 634
        },
        {
          "name": "image2",
          "type": "IMAGE",
          "link": 632
        },
        {
          "name": "image3",
          "type": "IMAGE",
          "link": 633
        }
      ],
      "outputs": [
        {
          "name": "conditioning",
          "type": "CONDITIONING",
          "links": [
            635,
            637
          ]
        },
        {
          "name": "image",
          "type": "IMAGE",
          "links": null
        },
        {
          "name": "latent",
          "type": "LATENT",
          "links": null
        }
      ],
      "properties": {
        "Node name for S&R": "QI_TextEncodeQwenImageEdit_Safe"
      },
      "widgets_values": [
        "构图改为特写，图一的老人抱着图二的女人在图三的背景中，保持图二人物一致性",
        true,
        "reflect",
        8,
        "both",
        true,
        16777216,
        "You are a Prompt optimizer for image generation. Evaluate the user's input: if it requires expansion (e.g., due to vagueness, multiple characters without clear distinction, or missing details), enhance it by adding precise feature descriptions, using unique labels per character, ensuring visual distinctions, and including quality tags like \"Ultra HD, 4K, cinematic lighting\". If the input is already detailed and clear, output it verbatim. Keep enhanced prompts under 300 words."
      ]
    }
  ],
  "links": [
    [
      213,
      66,
      0,
      116,
      0,
      "MODEL"
    ],
    [
      214,
      116,
      0,
      3,
      0,
      "MODEL"
    ],
    [
      281,
      37,
      0,
      80,
      0,
      "MODEL"
    ],
    [
      335,
      39,
      0,
      161,
      0,
      "VAE"
    ],
    [
      336,
      3,
      0,
      161,
      1,
      "LATENT"
    ],
    [
      410,
      80,
      0,
      66,
      0,
      "MODEL"
    ],
    [
      455,
      161,
      0,
      160,
      0,
      "IMAGE"
    ],
    [
      591,
      197,
      0,
      3,
      3,
      "LATENT"
    ],
    [
      602,
      147,
      0,
      3,
      2,
      "CONDITIONING"
    ],
    [
      616,
      110,
      0,
      248,
      1,
      "IMAGE"
    ],
    [
      617,
      39,
      0,
      248,
      2,
      "VAE"
    ],
    [
      618,
      198,
      0,
      248,
      3,
      "IMAGE"
    ],
    [
      619,
      71,
      0,
      248,
      4,
      "IMAGE"
    ],
    [
      620,
      248,
      0,
      147,
      0,
      "CONDITIONING"
    ],
    [
      621,
      248,
      0,
      3,
      1,
      "CONDITIONING"
    ],
    [
      623,
      251,
      0,
      252,
      1,
      "LATENT"
    ],
    [
      630,
      195,
      0,
      260,
      0,
      "CLIP"
    ],
    [
      631,
      110,
      0,
      260,
      1,
      "IMAGE"
    ],
    [
      632,
      198,
      0,
      260,
      3,
      "IMAGE"
    ],
    [
      633,
      71,
      0,
      260,
      4,
      "IMAGE"
    ],
    [
      634,
      39,
      0,
      260,
      2,
      "VAE"
    ],
    [
      635,
      260,
      0,
      261,
      0,
      "CONDITIONING"
    ],
    [
      636,
      261,
      0,
      251,
      2,
      "CONDITIONING"
    ],
    [
      637,
      260,
      0,
      251,
      1,
      "CONDITIONING"
    ],
    [
      638,
      197,
      0,
      251,
      3,
      "LATENT"
    ],
    [
      639,
      116,
      0,
      251,
      0,
      "MODEL"
    ],
    [
      640,
      39,
      0,
      252,
      0,
      "VAE"
    ],
    [
      641,
      252,
      0,
      262,
      0,
      "IMAGE"
    ],
    [
      644,
      195,
      0,
      248,
      0,
      "CLIP"
    ]
  ],
  "groups": [
    {
      "id": 4,
      "title": "Prompt",
      "bounding": [
        294.2326965332031,
        77.77818298339844,
        490,
        430
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 5,
      "title": "Dont worry be happy. --by wallen0322",
      "bounding": [
        -793.4883422851562,
        -831.7056884765625,
        2200.9990234375,
        217.657470703125
      ],
      "color": "#a1309b",
      "font_size": 128,
      "flags": {}
    }
  ],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.5730855330117041,
      "offset": [
        2619.9861548116746,
        619.6556393586071
      ]
    },
    "frontendVersion": "1.26.13",
    "VHS_latentpreview": true,
    "VHS_latentpreviewrate": 0,
    "VHS_MetadataImage": true,
    "VHS_KeepIntermediate": true
  },
  "version": 0.4
}